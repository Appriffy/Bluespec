{"version":3,"sources":["src/app/user/listing/user-map-listing/user-map-listing.page.html","src/app/user/listing/user-map-listing/user-map-listing.module.ts","src/app/user/listing/user-map-listing/user-map-listing.page.scss","src/app/user/listing/user-map-listing/user-map-listing.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n\\n    <ion-buttons slot=\\\"start\\\">\\n      \\n      <ion-buttons  (click)=\\\"prevStep()\\\">\\n        <ion-button fill=\\\"outline\\\" color=\\\"facebook\\\">Back</ion-button>\\n      </ion-buttons>\\n\\n    </ion-buttons>\\n    <ion-title slot=\\\"\\\">Select Location</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n     \\n      <ion-buttons  (click)=\\\"nextStep()\\\">\\n        <ion-button fill=\\\"outline\\\" color=\\\"facebook\\\">FILTER</ion-button>\\n      </ion-buttons>\\n\\n    </ion-buttons>\\n    \\n  </ion-toolbar>\\n\\n  <!-- <ion-toolbar>\\n    <ion-searchbar [(ngModel)]=\\\"query\\\" (ionInput)=\\\"searchPlace()\\\"></ion-searchbar>\\n</ion-toolbar> -->\\n\\n</ion-header>\\n\\n<ion-content class=\\\"create-user-content\\\">\\n  <app-map *ngIf=\\\"(coordinates$|async) as coords\\\" [coords]=\\\"coords\\\"></app-map>\\n  \\n</ion-content>\\n\\n<ion-footer>\\n  <!-- <div class=\\\"users-pictures-wrapper\\\">\\n    <h3 class=\\\"detail-title\\\">Select a radius you can offer your service.</h3>\\n    <ion-row class=\\\"pictures-row\\\">\\n     \\n    </ion-row>\\n    <ion-button class=\\\"upload-picture-btn\\\" color=\\\"dark\\\" expand=\\\"block\\\" fill=\\\"outline\\\">Set Default Location</ion-button>\\n  </div> -->\\n\\n  <ion-item-group class=\\\"filters-content filters-group\\\">\\n  <ion-item-divider>\\n    <ion-label>Lat: {{currentLat}}, Lat: {{currentLong}}</ion-label>\\n  </ion-item-divider>\\n  <!-- <form [formGroup]=\\\"filterUsersForm\\\" class=\\\"range-list\\\" (ngSubmit)=\\\"saveLocationPrefs()\\\">\\n\\n    <ion-row class=\\\"range-item\\\" style=\\\"display:none;\\\">\\n      <ion-col size=\\\"6\\\">\\n        <ion-item class=\\\"input-item\\\">\\n          <ion-label color=\\\"secondary\\\" position=\\\"floating\\\">Latitude</ion-label>\\n          <ion-input type=\\\"text\\\" formControlName=\\\"latitude\\\" required></ion-input>\\n        </ion-item>\\n      </ion-col>\\n      <ion-col size=\\\"6\\\">\\n        <ion-item class=\\\"input-item\\\">\\n          <ion-label color=\\\"secondary\\\" position=\\\"floating\\\">Longitude</ion-label>\\n          <ion-input type=\\\"text\\\" formControlName=\\\"longitude\\\" required></ion-input>\\n        </ion-item>\\n      </ion-col>\\n    </ion-row>\\n\\n    <ion-row class=\\\"range-item\\\">\\n      <ion-col size=\\\"12\\\">\\n        <div class=\\\"range-header\\\">\\n          <span class=\\\"range-label\\\" style=\\\"margin-left:15px;\\\">How far can you offer your service?</span>\\n          <span class=\\\"range-value\\\">{{ rangeForm.controls.radius.value }}</span>\\n        </div>\\n      </ion-col>\\n      <ion-col size=\\\"12\\\">\\n        <ion-range class=\\\"range-control\\\" formControlName=\\\"radius\\\" color=\\\"secondary\\\" (ionChange)=\\\"rangeChange($event)\\\" min=\\\"0\\\" max=\\\"50\\\" step=\\\"1\\\"></ion-range>\\n      </ion-col>\\n    </ion-row>\\n  </form> -->\\n</ion-item-group>\\n\\n\\n<ion-row class=\\\"details-purchase-options-row\\\">\\n \\n  <ion-col size=\\\"6\\\">\\n    <ion-button class=\\\"select-variant-btn\\\" color=\\\"medium\\\" expand=\\\"block\\\" fill=\\\"outline\\\" (click)=\\\"addMarkerTest()\\\">Add Marker</ion-button>\\n  </ion-col>\\n  <ion-col size=\\\"6\\\" class=\\\"main-call-to-action-col\\\">\\n    <ion-button class=\\\"add-to-cart-btn\\\" color=\\\"dark\\\" expand=\\\"block\\\" fill=\\\"solid\\\">More Action</ion-button>\\n  </ion-col>\\n</ion-row>\\n\\n\\n  <ion-row class=\\\"form-actions-wrapper\\\">\\n    <ion-col>\\n      <ion-button class=\\\"submit-btn\\\" expand=\\\"block\\\" color=\\\"secondary\\\" type=\\\"submit\\\" fill=\\\"solid\\\"><ion-icon name=\\\"arrow-round-forward\\\"></ion-icon>&nbsp; LOCATE ON MAP</ion-button>\\n    </ion-col>\\n  </ion-row>\\n</ion-footer>\\n\"","import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserMapListingPage } from './user-map-listing.page';\nimport { SharedModule } from '../../../shared/components/map/shared.module';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserMapListingPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    SharedModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [UserMapListingPage ],\n  schemas: [CUSTOM_ELEMENTS_SCHEMA]\n})\nexport class UserMapListingPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3VzZXIvbGlzdGluZy91c2VyLW1hcC1saXN0aW5nL3VzZXItbWFwLWxpc3RpbmcucGFnZS5zY3NzIn0= */\"","import { Component, OnInit, AfterViewInit, Input, ViewChild, ElementRef } from '@angular/core';\nimport { MenuController } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { Capacitor, Plugins, GeolocationPlugin, GeolocationPosition} from '@capacitor/core';\nimport {Observable, of, from as fromPromise} from 'rxjs';\nimport { tap, map, switchMap} from 'rxjs/operators';\nimport { LoadingController, AlertController} from '@ionic/angular';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MapComponent } from '../../../shared/components/map/map.component';\nconst { Toast, Geolocation} = Capacitor.Plugins;\n\n@Component({\n  selector: 'app-user-map-listing',\n  templateUrl: './user-map-listing.page.html',\n  styleUrls: ['./user-map-listing.page.scss'],\n})\nexport class UserMapListingPage implements OnInit {\n  @ViewChild(MapComponent, {static: false}) mapComponent: MapComponent;\n  public coordinates$: Observable<GeolocationPosition>;\n  public defaultPos = {latitude: 42, longitude: 2};\n  currentLat:number;\n  currentLong : number;\n  search_radius:number;\n  filterUsersForm : FormGroup;\n  constructor(public router: Router,\n    public menu: MenuController,\n    private loadingController: LoadingController,\n    private alertController: AlertController) {\n     }\n\n\n  ngOnInit() {\n    this.filterUsersForm = new FormGroup({\n      latitude: new FormControl('', Validators.required),\n      longitude: new FormControl('', Validators.required)\n      //radius: new FormControl(10, counterRangeValidator(1, 200))\n    });\n\n    this.displayLoader()\n    .then((loader: any) => {\n      // get position\n      return this.getCurrentPosition()\n        .then(position => {\n          let latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n                let mapOptions = {\n                    center: latLng,\n                    zoom: 15\n                };\n             //alert(position.coords.latitude+\", \"+ position.coords.longitude); \n             this.currentLat = position.coords.latitude;\n             this.currentLong = position.coords.longitude;\n            //  this.filterUsersForm.controls.latitude.setValue(this.currentLat);\n            //  this.filterUsersForm.controls.longitude.setValue(this.currentLong);\n          // fermer loader + return position\n          loader.dismiss();\n          return position;\n        })\n        // if error\n        .catch(err => {\n          // fermer loader + return NULL\n          loader.dismiss();\n          return null;\n        });\n    })\n    .then(position => (position instanceof Error) ? this.presentAlert(position.message) : null)\n    // do not forget to handle promise rejection\n    .catch(err => {\n      this.presentAlert(err.message);\n    });\n\n\n    // let center = this.mapComponent.map.getCenter();\n    // this.mapComponent.addMarker(center.lat(), center.lng());\n  }\n\n  async displayLoader(){\n    const loading = this.loadingController.create({\n      animated:true,\n      spinner: \"bubbles\",\n      message: 'Please wait...',\n      translucent: true\n    });\n    await (await loading).present();\n    return loading;\n  }\n\n  private async presentAlert(message: string): Promise<HTMLIonAlertElement> {\n  \n    const alert = await this.alertController.create({\n      header: 'Alert!',\n      subHeader: 'Wadfak',\n      message: message,\n      buttons: ['OK']\n    });\n    await alert.present();\n    return alert;\n  }\n\n  private async getCurrentPosition(): Promise<any> {\n    const isAvailable: boolean = Capacitor.isPluginAvailable('Geolocation');\n    if (!isAvailable) {\n      console.log('Err: plugin not available');\n      return of(new Error('Err: plugin not available'));\n    }\n    const POSITION = Plugins.Geolocation.getCurrentPosition()\n    // handle Capacitor Errors\n    .catch(err => {\n      console.log('ERR', err);\n      return new Error(err.message || 'message perso');\n    });\n\n    this.coordinates$ = fromPromise(POSITION).pipe(\n      switchMap((data: any) => of(data.coords)),\n      tap(data => console.log(data))\n    );\n    return POSITION;\n  }\n\n\n  saveLocationPrefs(){\n    alert(\"This feature is coming.\");\n  }\n\n  addMarkerTest(){\n    this.mapComponent.addMarker(42, 9);\n  }\n\n}\n"],"sourceRoot":"webpack:///","file":"user-listing-user-map-listing-user-map-listing-module-es5.js"}