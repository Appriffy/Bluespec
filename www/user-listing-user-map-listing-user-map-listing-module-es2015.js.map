{"version":3,"sources":["./src/app/user/listing/user-map-listing/user-map-listing.page.html","./src/app/user/listing/user-map-listing/user-map-listing.module.ts","./src/app/user/listing/user-map-listing/user-map-listing.page.scss","./src/app/user/listing/user-map-listing/user-map-listing.page.ts"],"names":[],"mappings":"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","file":"user-listing-user-map-listing-user-map-listing-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n\\n    <ion-buttons slot=\\\"start\\\">\\n      \\n      <ion-buttons  (click)=\\\"prevStep()\\\">\\n        <ion-button fill=\\\"outline\\\" color=\\\"facebook\\\">Back</ion-button>\\n      </ion-buttons>\\n\\n    </ion-buttons>\\n    <ion-title slot=\\\"\\\">Select Location</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n     \\n      <ion-buttons  (click)=\\\"nextStep()\\\">\\n        <ion-button fill=\\\"outline\\\" color=\\\"facebook\\\">FILTER</ion-button>\\n      </ion-buttons>\\n\\n    </ion-buttons>\\n    \\n  </ion-toolbar>\\n\\n  <!-- <ion-toolbar>\\n    <ion-searchbar [(ngModel)]=\\\"query\\\" (ionInput)=\\\"searchPlace()\\\"></ion-searchbar>\\n</ion-toolbar> -->\\n\\n</ion-header>\\n\\n<ion-content class=\\\"create-user-content\\\">\\n  <app-map *ngIf=\\\"(coordinates$|async) as coords\\\" [coords]=\\\"coords\\\"></app-map>\\n  \\n</ion-content>\\n\\n<ion-footer>\\n  <!-- <div class=\\\"users-pictures-wrapper\\\">\\n    <h3 class=\\\"detail-title\\\">Select a radius you can offer your service.</h3>\\n    <ion-row class=\\\"pictures-row\\\">\\n     \\n    </ion-row>\\n    <ion-button class=\\\"upload-picture-btn\\\" color=\\\"dark\\\" expand=\\\"block\\\" fill=\\\"outline\\\">Set Default Location</ion-button>\\n  </div> -->\\n\\n  <ion-item-group class=\\\"filters-content filters-group\\\">\\n  <ion-item-divider>\\n    <ion-label>Lat: {{currentLat}}, Lat: {{currentLong}}</ion-label>\\n  </ion-item-divider>\\n  <!-- <form [formGroup]=\\\"filterUsersForm\\\" class=\\\"range-list\\\" (ngSubmit)=\\\"saveLocationPrefs()\\\">\\n\\n    <ion-row class=\\\"range-item\\\" style=\\\"display:none;\\\">\\n      <ion-col size=\\\"6\\\">\\n        <ion-item class=\\\"input-item\\\">\\n          <ion-label color=\\\"secondary\\\" position=\\\"floating\\\">Latitude</ion-label>\\n          <ion-input type=\\\"text\\\" formControlName=\\\"latitude\\\" required></ion-input>\\n        </ion-item>\\n      </ion-col>\\n      <ion-col size=\\\"6\\\">\\n        <ion-item class=\\\"input-item\\\">\\n          <ion-label color=\\\"secondary\\\" position=\\\"floating\\\">Longitude</ion-label>\\n          <ion-input type=\\\"text\\\" formControlName=\\\"longitude\\\" required></ion-input>\\n        </ion-item>\\n      </ion-col>\\n    </ion-row>\\n\\n    <ion-row class=\\\"range-item\\\">\\n      <ion-col size=\\\"12\\\">\\n        <div class=\\\"range-header\\\">\\n          <span class=\\\"range-label\\\" style=\\\"margin-left:15px;\\\">How far can you offer your service?</span>\\n          <span class=\\\"range-value\\\">{{ rangeForm.controls.radius.value }}</span>\\n        </div>\\n      </ion-col>\\n      <ion-col size=\\\"12\\\">\\n        <ion-range class=\\\"range-control\\\" formControlName=\\\"radius\\\" color=\\\"secondary\\\" (ionChange)=\\\"rangeChange($event)\\\" min=\\\"0\\\" max=\\\"50\\\" step=\\\"1\\\"></ion-range>\\n      </ion-col>\\n    </ion-row>\\n  </form> -->\\n</ion-item-group>\\n\\n\\n<ion-row class=\\\"details-purchase-options-row\\\">\\n \\n  <ion-col size=\\\"6\\\">\\n    <ion-button class=\\\"select-variant-btn\\\" color=\\\"medium\\\" expand=\\\"block\\\" fill=\\\"outline\\\" (click)=\\\"addMarkerTest()\\\">Add Marker</ion-button>\\n  </ion-col>\\n  <ion-col size=\\\"6\\\" class=\\\"main-call-to-action-col\\\">\\n    <ion-button class=\\\"add-to-cart-btn\\\" color=\\\"dark\\\" expand=\\\"block\\\" fill=\\\"solid\\\">More Action</ion-button>\\n  </ion-col>\\n</ion-row>\\n\\n\\n  <ion-row class=\\\"form-actions-wrapper\\\">\\n    <ion-col>\\n      <ion-button class=\\\"submit-btn\\\" expand=\\\"block\\\" color=\\\"secondary\\\" type=\\\"submit\\\" fill=\\\"solid\\\"><ion-icon name=\\\"arrow-round-forward\\\"></ion-icon>&nbsp; LOCATE ON MAP</ion-button>\\n    </ion-col>\\n  </ion-row>\\n</ion-footer>\\n\"","import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserMapListingPage } from './user-map-listing.page';\nimport { SharedModule } from '../../../shared/components/map/shared.module';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserMapListingPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    SharedModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [UserMapListingPage ],\n  schemas: [CUSTOM_ELEMENTS_SCHEMA]\n})\nexport class UserMapListingPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3VzZXIvbGlzdGluZy91c2VyLW1hcC1saXN0aW5nL3VzZXItbWFwLWxpc3RpbmcucGFnZS5zY3NzIn0= */\"","import { Component, OnInit, AfterViewInit, Input, ViewChild, ElementRef } from '@angular/core';\nimport { MenuController } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { Capacitor, Plugins, GeolocationPlugin, GeolocationPosition} from '@capacitor/core';\nimport {Observable, of, from as fromPromise} from 'rxjs';\nimport { tap, map, switchMap} from 'rxjs/operators';\nimport { LoadingController, AlertController} from '@ionic/angular';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MapComponent } from '../../../shared/components/map/map.component';\nconst { Toast, Geolocation} = Capacitor.Plugins;\n\n@Component({\n  selector: 'app-user-map-listing',\n  templateUrl: './user-map-listing.page.html',\n  styleUrls: ['./user-map-listing.page.scss'],\n})\nexport class UserMapListingPage implements OnInit {\n  @ViewChild(MapComponent, {static: false}) mapComponent: MapComponent;\n  public coordinates$: Observable<GeolocationPosition>;\n  public defaultPos = {latitude: 42, longitude: 2};\n  currentLat:number;\n  currentLong : number;\n  search_radius:number;\n  filterUsersForm : FormGroup;\n  constructor(public router: Router,\n    public menu: MenuController,\n    private loadingController: LoadingController,\n    private alertController: AlertController) {\n     }\n\n\n  ngOnInit() {\n    this.filterUsersForm = new FormGroup({\n      latitude: new FormControl('', Validators.required),\n      longitude: new FormControl('', Validators.required)\n      //radius: new FormControl(10, counterRangeValidator(1, 200))\n    });\n\n    this.displayLoader()\n    .then((loader: any) => {\n      // get position\n      return this.getCurrentPosition()\n        .then(position => {\n          let latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n                let mapOptions = {\n                    center: latLng,\n                    zoom: 15\n                };\n             //alert(position.coords.latitude+\", \"+ position.coords.longitude); \n             this.currentLat = position.coords.latitude;\n             this.currentLong = position.coords.longitude;\n            //  this.filterUsersForm.controls.latitude.setValue(this.currentLat);\n            //  this.filterUsersForm.controls.longitude.setValue(this.currentLong);\n          // fermer loader + return position\n          loader.dismiss();\n          return position;\n        })\n        // if error\n        .catch(err => {\n          // fermer loader + return NULL\n          loader.dismiss();\n          return null;\n        });\n    })\n    .then(position => (position instanceof Error) ? this.presentAlert(position.message) : null)\n    // do not forget to handle promise rejection\n    .catch(err => {\n      this.presentAlert(err.message);\n    });\n\n\n    // let center = this.mapComponent.map.getCenter();\n    // this.mapComponent.addMarker(center.lat(), center.lng());\n  }\n\n  async displayLoader(){\n    const loading = this.loadingController.create({\n      animated:true,\n      spinner: \"bubbles\",\n      message: 'Please wait...',\n      translucent: true\n    });\n    await (await loading).present();\n    return loading;\n  }\n\n  private async presentAlert(message: string): Promise<HTMLIonAlertElement> {\n  \n    const alert = await this.alertController.create({\n      header: 'Alert!',\n      subHeader: 'Wadfak',\n      message: message,\n      buttons: ['OK']\n    });\n    await alert.present();\n    return alert;\n  }\n\n  private async getCurrentPosition(): Promise<any> {\n    const isAvailable: boolean = Capacitor.isPluginAvailable('Geolocation');\n    if (!isAvailable) {\n      console.log('Err: plugin not available');\n      return of(new Error('Err: plugin not available'));\n    }\n    const POSITION = Plugins.Geolocation.getCurrentPosition()\n    // handle Capacitor Errors\n    .catch(err => {\n      console.log('ERR', err);\n      return new Error(err.message || 'message perso');\n    });\n\n    this.coordinates$ = fromPromise(POSITION).pipe(\n      switchMap((data: any) => of(data.coords)),\n      tap(data => console.log(data))\n    );\n    return POSITION;\n  }\n\n\n  saveLocationPrefs(){\n    alert(\"This feature is coming.\");\n  }\n\n  addMarkerTest(){\n    this.mapComponent.addMarker(42, 9);\n  }\n\n}\n"],"sourceRoot":"webpack:///"}